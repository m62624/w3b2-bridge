# Руководство по управлению кошельками и администраторами

## Обзор

Система W3B2 Bridge предоставляет полный набор инструментов для создания кошельков и управления администраторами. Это руководство объясняет, как использовать эти функции.

## Создание кошельков

### 1. Автоматическая генерация
- Перейдите в раздел "Управление кошельками" в приложении
- Нажмите кнопку "Создать кошелек" для генерации нового кошелька
- Каждый кошелек генерируется с уникальными публичным и приватным ключами

### 2. Экспорт кошельков
- Сгенерированные кошельки можно экспортировать в JSON формате
- Файл содержит публичный ключ, приватный ключ (в Base64) и метаданные
- Используйте кнопку "Экспорт" для сохранения кошелька

### 3. Копирование ключей
- Используйте кнопки "Копировать" для быстрого копирования ключей в буфер обмена
- Публичные ключи можно безопасно передавать
- Приватные ключи должны храниться в безопасности

## Регистрация администраторов

### 1. Подготовка ключей
Для регистрации администратора вам понадобятся:
- **Authority** - публичный ключ администратора (кто будет управлять)
- **Co-signer** - уникальный ключ для PDA (Program Derived Address)
- **Funding Amount** - сумма финансирования в lamports (1 SOL = 1,000,000,000 lamports)

### 2. Процесс регистрации
1. Перейдите в раздел "Управление кошельками"
2. Нажмите "Регистрация админа"
3. Заполните форму:
   - Введите публичный ключ администратора
   - Введите co-signer ключ (можно сгенерировать новый кошелек)
   - Укажите сумму финансирования
4. Нажмите "Зарегистрировать"

### 3. Что происходит при регистрации
- Создается PDA (Program Derived Address) для администратора
- Администратор регистрируется в блокчейне Solana
- Информация сохраняется в локальной базе данных
- Администратор получает указанную сумму финансирования

## Структура данных

### Кошелек
```json
{
  "publicKey": "string",     // Публичный ключ в Base58
  "privateKey": "string",    // Приватный ключ в Base64
  "timestamp": "number"      // Время создания
}
```

### Администратор
```json
{
  "public_key": "string",    // Публичный ключ администратора
  "co_signer": "string",     // Co-signer ключ
  "is_registered": "boolean", // Статус регистрации
  "funding_amount": "number", // Сумма финансирования в lamports
  "created_at": "number",    // Время создания
  "last_activity": "number"  // Последняя активность
}
```

## Безопасность

### Рекомендации по безопасности
1. **Никогда не передавайте приватные ключи** третьим лицам
2. **Делайте резервные копии** экспортированных кошельков
3. **Используйте разные co-signer ключи** для каждого администратора
4. **Регулярно проверяйте** список зарегистрированных администраторов

### Хранение ключей
- Приватные ключи хранятся в Base64 формате
- Кошельки можно экспортировать в JSON файлы
- Рекомендуется хранить экспортированные файлы в безопасном месте

## API Эндпоинты

### Регистрация администратора
```
POST /api/register-admin
{
  "authority": "string",     // Публичный ключ администратора
  "coSigner": "string",      // Co-signer ключ
  "fundingAmount": "number"  // Сумма в lamports
}
```

### Получение списка администраторов
```
GET /api/admins
```

### Получение баланса
```
GET /api/balance/:publicKey
```

### Получение airdrop (для тестирования)
```
POST /api/airdrop
{
  "publicKey": "string"
}
```

## Примеры использования

### Создание тестового администратора
1. Сгенерируйте два новых кошелька:
   - Один для authority
   - Один для co-signer
2. Получите airdrop для authority кошелька
3. Зарегистрируйте администратора с суммой 1 SOL (1,000,000,000 lamports)

### Работа с существующими кошельками
1. Импортируйте существующий кошелек через интерфейс кошелька
2. Используйте его публичный ключ для регистрации администратора
3. Сгенерируйте новый co-signer ключ

## Устранение неполадок

### Ошибка "Insufficient funds"
- Убедитесь, что у authority кошелька достаточно SOL для комиссии
- Получите airdrop для тестирования

### Ошибка "InstructionFallbackNotFound"
- Проверьте, что используется правильная версия программы
- Убедитесь, что программа развернута в блокчейне

### Ошибка "Non-base58 character"
- Убедитесь, что приватные ключи передаются в правильном формате (Base64)
- Проверьте, что нет лишних символов в ключах

## Поддержка

Если у вас возникли проблемы:
1. Проверьте логи в консоли браузера
2. Проверьте логи бэкенда
3. Убедитесь, что все сервисы запущены
4. Проверьте подключение к Solana devnet
